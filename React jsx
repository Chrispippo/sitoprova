import React, { useState, useEffect } from 'react';
import comuniData from './comuni.json';

const AddressForm = () => {
  const [selectedProvincia, setSelectedProvincia] = useState('');
  const [filteredComuni, setFilteredComuni] = useState([]);
  const [selectedComune, setSelectedComune] = useState('');

  useEffect(() => {
    if (selectedProvincia) {
      const comuniFiltrati = comuniData.filter(item => item.provincia === selectedProvincia);
      setFilteredComuni(comuniFiltrati);
      setSelectedComune('');
    }
  }, [selectedProvincia]);

  return (
    <form>
      <div>
        <label>Provincia:</label>
        <select value={selectedProvincia} onChange={(e) => setSelectedProvincia(e.target.value)}>
          <option value="">-- Seleziona Provincia --</option>
          {Array.from(new Set(comuniData.map(item => item.provincia))).map((prov, idx) => (
            <option key={idx} value={prov}>{prov}</option>
          ))}
        </select>
      </div>
      <div>
        <label>Comune:</label>
        <select value={selectedComune} onChange={(e) => setSelectedComune(e.target.value)}>
          <option value="">-- Seleziona Comune --</option>
          {filteredComuni.map((item, idx) => (
            <option key={idx} value={item.comune}>
              {item.comune} - {item.cap}
            </option>
          ))}
        </select>
      </div>
      {/* Altri campi del form (indirizzo, ecc.) */}
      <button type="submit">Invia</button>
    </form>
  );
};

export default AddressForm;
